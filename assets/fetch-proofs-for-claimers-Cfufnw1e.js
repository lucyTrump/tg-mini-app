const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DAt5dF0_.js","assets/index-BPvgi06w.css"])))=>i.map(i=>d[i]);
import{ac as S,ad as A,j as O,q as H,ae as b,af as q,ag as v,ah as z,ai as j,aj as F,ak as M,al as V,am as B,an as J,ao as Z,_ as d,H as $,ap as W,aq as Q,a5 as p,J as k,ar as G,a7 as E,as as K,at as X,au as Y,av as tt,aw as f,ax as T,ay as D}from"./index-DAt5dF0_.js";function et(r,t){if(r.length!==t.length)throw new S({expectedLength:r.length,givenLength:t.length});const e=[];for(let n=0;n<r.length;n++){const a=r[n],i=t[n];e.push(U(a,i))}return A(e)}function U(r,t,e=!1){if(r==="address"){const s=t;if(!O(s))throw new H({address:s});return b(s.toLowerCase(),{size:e?32:null})}if(r==="string")return q(t);if(r==="bytes")return t;if(r==="bool")return b(v(t),{size:e?32:1});const n=r.match(z);if(n){const[s,c,o="256"]=n,l=Number.parseInt(o)/8;return j(t,{size:e?32:l,signed:c==="int"})}const a=r.match(F);if(a){const[s,c]=a;if(Number.parseInt(c)!==(t.length-2)/2)throw new M({expectedSize:Number.parseInt(c),givenSize:(t.length-2)/2});return b(t,{dir:"right",size:e?32:null})}const i=r.match(V);if(i&&Array.isArray(t)){const[s,c]=i,o=[];for(let l=0;l<t.length;l++)o.push(U(c,t[l],!0));return o.length===0?"0x":A(o)}throw new B(r)}async function rt(r){const{client:t,uri:e}=r;if(J(e))try{return JSON.parse(Z(e))}catch(a){console.error("Failed to decode base64 encoded contract metadata",{uri:e},a);return}const{download:n}=await d(async()=>{const{download:a}=await import("./index-DAt5dF0_.js").then(i=>i.e2);return{download:a}},__vite__mapDeps([0,1]));return await(await n({client:t,uri:e})).json()}const at="0xe8a3d485",nt=[],st=[{type:"string"}];async function it(r){return $({contract:r.contract,method:[at,nt,st],params:[]})}async function ct(r){const[t,e,n]=await Promise.all([it(r).then(a=>a?rt({client:r.contract.client,uri:a}):null).catch(()=>null),W(r).catch(()=>null),Q(r).catch(()=>null)]);return{...t,name:(t==null?void 0:t.name)??e,symbol:(t==null?void 0:t.symbol)??n}}class ot{constructor(t){Object.defineProperty(this,"leaves",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"layers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.leaves=t.map(e=>e instanceof Uint8Array?e:p(e)),this.leaves=this.leaves.sort(),this.createHashes(this.leaves)}getHexRoot(){return k(this.getRoot())}getHexProof(t,e){return this.getProof(t,e).map(n=>k(n.data))}createHashes(t){for(this.layers=[t];t.length>1;){const e=this.layers.length;this.layers.push([]);const n=t.length;for(let a=0;a<t.length;a+=2){if(a>=n){this.layers[e].push(...t.slice(n));break}if(a+1===t.length&&t.length%2===1){this.layers[e].push(t[a]);continue}const i=t[a],s=a+1===t.length?i:t[a+1],c=[i,s];c.sort(G);const o=E(K(c),"bytes");this.layers[e].push(o)}t=this.layers[e]}}getRoot(){return this.layers.length===0?new Uint8Array:this.layers[this.layers.length-1][0]||new Uint8Array}getProof(t,e){if(typeof t>"u")throw new Error("leaf is required");t=t instanceof Uint8Array?t:p(t);const n=[];if(!Number.isInteger(e)){e=-1;for(let a=0;a<this.leaves.length;a++)X(t,this.leaves[a])&&(e=a)}if(e<=-1)return[];for(let a=0;a<this.layers.length;a++){const i=this.layers[a],s=e%2,c=s?e-1:e+1;c<i.length&&n.push({position:s?"left":"right",data:i[c]}),e=e/2|0}return n}}function g(r){const{quantity:t,tokenDecimals:e}=r;return t==="unlimited"?Y:tt(t,e)}async function P(r){const t=r.entry.currencyAddress||f,e=await(async()=>{if(T(t)||t===f)return 18;const[{getContract:n},{decimals:a}]=await Promise.all([d(()=>import("./index-DAt5dF0_.js").then(s=>s.dZ),__vite__mapDeps([0,1])),d(()=>import("./index-DAt5dF0_.js").then(s=>s.e4),__vite__mapDeps([0,1]))]),i=n({address:t,chain:r.chain,client:r.client});return await a({contract:i})})();return E(et(["address","uint256","uint256","address"],[r.entry.address,g({quantity:r.entry.maxClaimable||"unlimited",tokenDecimals:r.tokenDecimals}),g({quantity:r.entry.price||"unlimited",tokenDecimals:e}),t]))}async function ht(r){const{contract:t,merkleRoot:e,claimer:n}=r,s=((await ct({contract:t})).merkle||{})[e];if(!s)return null;const o=await(await D({client:t.client,uri:s})).json(),l=n.slice(2,2+o.shardNybbles).toLowerCase(),R=o.baseUri.endsWith("/")?o.baseUri:`${o.baseUri}/`;let m;try{const h=`${R}${l}.json`;m=await(await D({client:t.client,uri:h})).json()}catch{return null}const I=await Promise.all(m.entries.map(async h=>P({entry:h,chain:t.chain,client:t.client,tokenDecimals:r.tokenDecimals}))),x=new ot(I),u=m.entries.find(h=>h.address.toLowerCase()===n.toLowerCase());if(!u)return null;const C=x.getHexProof(await P({entry:u,chain:t.chain,client:t.client,tokenDecimals:r.tokenDecimals})).concat(m.proofs),y=u.currencyAddress||f,L=await(async()=>{if(T(y)||y===f)return 18;const[{getContract:h},{decimals:_}]=await Promise.all([d(()=>import("./index-DAt5dF0_.js").then(w=>w.dZ),__vite__mapDeps([0,1])),d(()=>import("./index-DAt5dF0_.js").then(w=>w.e4),__vite__mapDeps([0,1]))]),N=h({address:y,chain:t.chain,client:t.client});return await _({contract:N})})();return{proof:C,quantityLimitPerWallet:g({quantity:u.maxClaimable||"unlimited",tokenDecimals:r.tokenDecimals}),pricePerToken:g({quantity:u.price||"unlimited",tokenDecimals:L}),currency:y}}export{ht as fetchProofsForClaimer};
